(this.webpackJsonpsetup=this.webpackJsonpsetup||[]).push([[0],{107:function(e,t,n){},130:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(48),s=n.n(c),i=n(82),o=(n(107),n(13)),u=n(6),l=n(176);function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1024,a=t<0?0:t,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],c=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,c)).toFixed(a))+" "+r[c]}var d=n(4),b=n.n(d),m=n(8),f=n(7),j=n(178),h=n(87),O=n(3),x=["managementCredentials"],g=r.a.createContext({}),v=g.Provider,y=function(e){var t=e.children,n={read:Object(a.useCallback)((function(e){return localStorage.getItem(e)}),[]),write:Object(a.useCallback)((function(e,t){return localStorage.setItem(e,t)}),[])},r=n.read,c=n.write,s=Object(a.useState)((function(){var e=r("data");if(e)return console.log(e),Object(m.a)({},JSON.parse(e))})),i=Object(o.a)(s,2),u=i[0],l=i[1],p=Object(a.useCallback)((function(e){l((function(t){var n=Object(m.a)(Object(m.a)({},t),e),a=(n.managementCredentials,Object(h.a)(n,x));return c("data",JSON.stringify(a)),n}))}),[l,c]),d=Object(m.a)(Object(m.a)({},u),{},{store:p});return Object(O.jsx)(v,{value:d,children:t})},I=n(84),k=n(83),w=n(33),C=n.n(w),A=n(85),N=n(72),S=n(175),T="2.0";function F(e){return M.apply(this,arguments)}function M(){return(M=Object(f.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new S.a({clientId:"0523c52d-806a-4f07-9dda-8950eb13055f",tenantId:t}),e.abrupt("return",n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,t,n){return P.apply(this,arguments)}function P(){return(P=Object(f.a)(b.a.mark((function e(t,n,a){var r,c,s,i,o,u,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new I.a(t,n),e.next=3,r.accounts.listBySubscription();case 3:if(c=e.sent,s=c.find((function(e){return e.name===a})),i=new RegExp("/subscriptions/".concat(n,"/resourceGroups/([\\S]+)/providers/Microsoft.Maps/accounts/").concat(a)),!(o=s.id.match(i))||2!==o.length){e.next=13;break}return u=o[1],e.next=11,r.accounts.listKeys(u,a);case 11:return l=e.sent,e.abrupt("return",{mapSubscriptionKey:l.primaryKey,mapLocation:"us",resourceGroupName:u});case 13:return e.abrupt("return",null);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t){return _.apply(this,arguments)}function _(){return(_=Object(f.a)(b.a.mark((function e(t,n){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new A.a(t,n),e.abrupt("return",a.apps.listBySubscription());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t){return z.apply(this,arguments)}function z(){return(z=Object(f.a)(b.a.mark((function e(t,n){var a,r,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getToken("https://apps.azureiotcentral.com/user_impersonation");case 2:return a=e.sent,n=n.split(".")[0]+".azureiotcentral.com",r="iotc-indm-".concat(Math.floor(2e4*Math.random())),e.next=7,C.a.put("https://".concat(n,"/api/apiTokens/").concat(r,"?api-version=").concat("1.0"),{roles:[{role:"ca310b8d-2f4a-44e0-a36e-957c202cd8d4"}],expiry:"2023-12-31T23:59:00.000Z"},{headers:{Authorization:"Bearer ".concat(a.token)}});case 7:if(200!==(c=e.sent).status){e.next=10;break}return e.abrupt("return",c.data.token);case 10:return e.abrupt("return",null);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,n,a){return B.apply(this,arguments)}function B(){return(B=Object(f.a)(b.a.mark((function e(t,n,a,r){var c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,e.next=3,C.a.post("https://".concat(n,".atlas.microsoft.com/mapData?api-version=").concat(T,"&dataFormat=dwgzippackage&subscription-key=").concat(a),t,{headers:{"Content-Type":"application/octet-stream"}});case 3:if(s=e.sent,r(c+=.1),!s.headers["operation-location"]){e.next=9;break}return e.next=8,J("".concat(s.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=e.headers["resource-location"].match(/https:\/\/us\.atlas\.microsoft\.com\/mapData\/metadata\/([\S]+)\?api-version=2\.0/);return t&&2===t.length?t[1]:null}),r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e,t,n){return K.apply(this,arguments)}function K(){return(K=Object(f.a)(b.a.mark((function e(t,n,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("https://".concat(n,".atlas.microsoft.com/conversions?api-version=").concat(T,"&udid=").concat(t,"&inputType=DWG&subscription-key=").concat(a,"&outputOntology=facility-2.0"));case 2:if(!(r=e.sent).headers["operation-location"]){e.next=7;break}return e.next=6,J("".concat(r.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=new RegExp("https://".concat(n,".atlas.microsoft.com/conversions/([\\S]+)\\?api-version=").concat(T)),a=e.headers["resource-location"].match(t);return a&&2===a.length?a[1]:null}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t,n,a){return V.apply(this,arguments)}function V(){return(V=Object(f.a)(b.a.mark((function e(t,n,a,r){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("https://".concat(n,".atlas.microsoft.com/datasets?api-version=").concat(T,"&conversionId=").concat(t,"&subscription-key=").concat(a).concat(r?"&datasetId=".concat(r):""));case 2:if(!(c=e.sent).headers["operation-location"]){e.next=7;break}return e.next=6,J("".concat(c.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=new RegExp("https://".concat(n,".atlas.microsoft.com/datasets/([\\S]+)\\?api-version=").concat(T)),a=e.headers["resource-location"].match(t);return a&&2===a.length?a[1]:null}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t,n){return Y.apply(this,arguments)}function Y(){return(Y=Object(f.a)(b.a.mark((function e(t,n,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("https://".concat(n,".atlas.microsoft.com/tilesets?api-version=").concat(T,"&datasetID=").concat(t,"&subscription-key=").concat(a));case 2:if(!(r=e.sent).headers["operation-location"]){e.next=7;break}return e.next=6,J("".concat(r.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=new RegExp("https://".concat(n,".atlas.microsoft.com/tilesets/([\\S]+)\\?api-version=").concat(T)),a=e.headers["resource-location"].match(t);return a&&2===a.length?a[1]:null}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t,n){return W.apply(this,arguments)}function W(){return(W=Object(f.a)(b.a.mark((function e(t,n,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("https://".concat(n,".atlas.microsoft.com/featurestatesets?api-version=").concat(T,"&datasetId=").concat(t,"&subscription-key=").concat(a),{styles:[{keyName:"occupied",type:"boolean",rules:[{true:"#8e5a00",false:"#FFFFFF"}]},{keyName:"temperature",type:"number",rules:[{range:{minimum:"13",exclusiveMaximum:"18"},color:"#0000FF"},{range:{minimum:"24"},color:"#FF0000"},{range:{minimum:"18",exclusiveMaximum:"24"},color:"#00FF00"}]}]},{headers:{"Content-Type":"application/json"}});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data.statesetId);case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t,n,a){return Z.apply(this,arguments)}function Z(){return(Z=Object(f.a)(b.a.mark((function e(t,n,a,r){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){var s=0,i=setInterval(Object(f.a)(b.a.mark((function o(){var u,l;return b.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return null===r||void 0===r||r(s+=.1),o.prev=1,o.next=4,C.a.get(t);case 4:200===(u=o.sent).status&&(n.body&&"Succeeded"===u.data[n.body]||n.header&&u.headers[n.header])&&(clearInterval(i),null===r||void 0===r||r(1),(l=a(u))?e(l):c(l)),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(1),c();case 11:case"end":return o.stop()}}),o,null,[[1,8]])}))),5e3)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t,n,a){return Q.apply(this,arguments)}function Q(){return(Q=Object(f.a)(b.a.mark((function e(t,n,a,r){var c,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new k.a(t,n),e.next=3,c.deployments.createOrUpdate("lucadruda","staticsite",{properties:{mode:"Incremental",template:N,parameters:Object.entries(Object(m.a)(Object(m.a)({},r),{},{scriptUri:"https://raw.githubusercontent.com/lucadruda/iotc-indoor-maps/indoor_maps/setup/src/azure/deployment_az.sh",siteFolder:"map-react",gitRepo:"https://github.com/lucadruda/iotc-indoor-maps",gitBranch:"indoor_maps"})).reduce((function(e,t){var n=Object(o.a)(t,2),a=n[0],r=n[1];return e[a]={value:r},e}),{})}});case 3:if(!(s=e.sent).id){e.next=7;break}if(!(null===(i=s.properties)||void 0===i?void 0:i.outputs)||!s.properties.outputs.staticWebsiteUrl){e.next=7;break}return e.abrupt("return",s.properties.outputs.staticWebsiteUrl.value);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X=n.p+"static/media/deployment.2fb82cf5.png",ee=n.p+"static/media/outputs.92ed6285.png",te=Object(u.u)({imageContainer:{display:"flex",flexDirection:"row",justifyContent:"space-around",marginVertical:20,width:"80%"},images:{width:"40%"},container:{display:"flex",flexDirection:"column",alignItems:"center"},deployBtn:{marginTop:10,marginBottom:10},form:{width:"60%",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",textAlign:"start"},formItems:{width:"100%"},clearText:{pointerEvents:"all",cursor:"pointer"}}),ne=r.a.memo(r.a.forwardRef((function(e,t){var n=e.enableNext,r=Object(a.useContext)(g),c=r.store,s=r.tenantId,i=r.subscriptionId,u=r.mapAccountName,l=Object(a.useState)({tenantId:s,subscriptionId:i,mapAccountName:u}),p=Object(o.a)(l,2),d=p[0],h=p[1];Object(a.useImperativeHandle)(t,(function(){return{process:function(){var e=Object(f.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(d.tenantId);case 2:return t=e.sent,e.next=5,R(t,d.subscriptionId,d.mapAccountName);case 5:(n=e.sent)&&c(Object(m.a)(Object(m.a)({},d),{},{managementCredentials:t,mapSubscriptionKey:n.mapSubscriptionKey,resourceGroup:n.resourceGroupName}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}),[c,d]);var x=Object(a.useRef)(!1);return Object(a.useEffect)((function(){d.subscriptionId&&d.tenantId&&d.mapAccountName&&!x.current&&(n(),x.current=!0)}),[d,n]),Object(O.jsxs)("div",{className:te.container,children:[Object(O.jsx)("h2",{children:"Deploy Maps account to your Azure Subscription"}),Object(O.jsx)("h4",{children:"Follow these steps to deploy an Azure Maps account."}),Object(O.jsx)("p",{children:'1. Click on the "Deploy" button to deploy the solution to your azure subscription.'}),Object(O.jsx)("p",{children:'2. Once deployment gets completed head over the "outputs" section and copy the values into the form below.'}),Object(O.jsx)("a",{href:"https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Flucadruda%2Fiotc-indoor-maps%2Findoor_maps%2Fsetup%2Fsrc%2Fazure%2Fazuredeploy.json",target:"_blank",rel:"noreferrer",children:Object(O.jsx)("div",{className:te.deployBtn,children:Object(O.jsx)("img",{src:"https://aka.ms/deploytoazurebutton",alt:"Deploy to Azure"})})}),Object(O.jsxs)("div",{className:te.imageContainer,children:[Object(O.jsx)("img",{className:te.images,src:X,alt:"deployment"}),Object(O.jsx)("img",{className:te.images,src:ee,alt:"outputs"})]}),Object(O.jsxs)("div",{className:te.form,children:[Object(O.jsx)(j.a,{className:te.formItems,label:"Subscription Id",value:d.subscriptionId,required:!0,iconProps:{iconName:"Cancel",onClick:function(e){h((function(e){return Object(m.a)(Object(m.a)({},e),{},{subscriptionId:""})}))},style:{pointerEvents:"all",cursor:"pointer"}},onChange:function(e,t){h((function(e){return Object(m.a)(Object(m.a)({},e),{},{subscriptionId:t})}))}}),Object(O.jsx)(j.a,{label:"Tenant Id",className:te.formItems,value:d.tenantId,required:!0,onChange:function(e,t){h((function(e){return Object(m.a)(Object(m.a)({},e),{},{tenantId:t})}))},iconProps:{iconName:"Cancel",onClick:function(e){h((function(e){return Object(m.a)(Object(m.a)({},e),{},{tenantId:""})}))},style:{pointerEvents:"all",cursor:"pointer"}}}),Object(O.jsx)(j.a,{label:"Map Account Name",className:te.formItems,required:!0,value:d.mapAccountName,onChange:function(e,t){h((function(e){return Object(m.a)(Object(m.a)({},e),{},{mapAccountName:t})}))},iconProps:{iconName:"Cancel",onClick:function(e){h((function(e){return Object(m.a)(Object(m.a)({},e),{},{mapAccountName:""})}))},style:{pointerEvents:"all",cursor:"pointer"}}})]})]})}))),ae=ne,re=n(58),ce=n(180),se=n(181),ie=n(86),oe=Object(u.u)({listGrid:{display:"flex",justifyContent:"center",alignItems:"center",gap:20},listGridItem:{padding:5,width:200,height:180,alignItems:"center",textAlign:"center",display:"inline-flex",justifyContent:"center",border:"1px solid black"},clickable:{backgroundColor:"#f3f2f1","&:hover":{backgroundColor:"#FFFFFF",cursor:"pointer"}},button:{display:"flex",flexDirection:"column"},coordinates:{marginTop:90},coordinatesForm:{display:"flex",flexDirection:"row",justifyContent:"space-evenly",paddingHorizontal:40},description:{margin:"5%"}}),ue=r.a.memo(r.a.forwardRef((function(e,t){var n=e.enableNext,c=Object(a.useState)([0,0]),s=Object(o.a)(c,2),i=s[0],u=s[1],l=Object(a.useContext)(g),d=l.mapSubscriptionKey,h=l.mapAccountName,x=l.store,v=l.drawingUUIDs,y=Object(a.useState)([].concat(Object(re.a)(null!==v&&void 0!==v?v:[]),[null])),I=Object(o.a)(y,2),k=I[0],w=I[1],C=Object(a.useRef)(!1),A=Object(a.useCallback)((function(e){e.forEach((function(e){var t=new FileReader;t.onload=Object(f.a)(b.a.mark((function n(){var a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,U(t.result,"us",d,(function(t){w((function(n){return n.map((function(n){return(null===n||void 0===n?void 0:n.name)===e.name?Object(m.a)(Object(m.a)({},n),{},{progress:t}):n}))}))}));case 2:(a=n.sent)&&w((function(t){return t.map((function(t){return(null===t||void 0===t?void 0:t.name)===e.name?Object(m.a)(Object(m.a)({},t),{},{uuid:a}):t}))}));case 4:case"end":return n.stop()}}),n)}))),t.readAsArrayBuffer(e),w((function(t){return[{name:e.name,size:p(e.size),progress:0}].concat(Object(re.a)(t))}))}))}),[w,d]),N=Object(ie.a)({onDrop:A,maxFiles:1,accept:".zip"}),S=N.getRootProps,T=N.getInputProps;Object(a.useImperativeHandle)(t,(function(){return{process:function(){x(Object(m.a)({drawingUUIDs:k.filter((function(e){return null!==e&&e.uuid}))},0!==i[0]&&0!==i[1]?{centerCoordinates:i}:{}))}}}),[x,k,i]),Object(a.useEffect)((function(){k.length>1&&!C.current&&(n(),C.current=!0)}),[k,n]);var F=r.a.useCallback((function(e,t){var n;return Object(O.jsx)("div",{className:"".concat(oe.listGridItem," ").concat(null===e?oe.clickable:""),children:null===e?Object(O.jsxs)("div",Object(m.a)(Object(m.a)({},S()),{},{children:[Object(O.jsx)("input",Object(m.a)({},T())),Object(O.jsxs)("div",{className:oe.button,children:[Object(O.jsx)(ce.a,{iconName:"AddIn"}),Object(O.jsx)("h3",{children:"Add a drawing"})]})]})):Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:e.name}),Object(O.jsx)(se.a,{label:e.progress<1?"Uploading package...":"Package ready.",description:null!==(n=e.uuid)&&void 0!==n?n:"",percentComplete:e.progress,progressHidden:1===e.progress}),Object(O.jsx)("h3",{children:e.size})]})},"upload-b-".concat(t))}),[T,S]);return d?Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Upload building drawings"}),Object(O.jsxs)("div",{children:[Object(O.jsx)("h3",{style:{display:"inline"},children:"Map account "}),Object(O.jsxs)("h4",{style:{display:"inline"},children:[' "',h,'" ']}),Object(O.jsx)("h3",{style:{display:"inline"},children:"found."})]}),Object(O.jsx)("div",{className:oe.description,children:Object(O.jsxs)("p",{children:["Upload your drawings in zip format.",Object(O.jsx)("br",{}),"For drawing package requirements, follow details"," ",Object(O.jsx)("a",{href:"https://docs.microsoft.com/en-us/azure/azure-maps/drawing-requirements",children:"here"})]})}),Object(O.jsx)("div",{className:oe.listGrid,children:k.map(F)}),Object(O.jsxs)("div",{className:oe.coordinates,children:[Object(O.jsx)("p",{children:"Optionally provide center coordinates to automatically zoom to specific location at map loading."}),Object(O.jsxs)("div",{className:oe.coordinatesForm,children:[Object(O.jsx)(j.a,{type:"number",label:"Latitude",value:i[0].toString(),onChange:function(e,t){u((function(e){return[parseFloat(t),e[1]]}))}}),Object(O.jsx)(j.a,{type:"number",label:"Longitude",value:i[1].toString(),onChange:function(e,t){u((function(e){return[e[0],parseFloat(t)]}))}})]})]})]}):Object(O.jsx)("div",{className:"centered",children:Object(O.jsx)(se.a,{className:"pageload",description:"Loading map details..."})})}))),le=n(31),pe=Object(u.u)({container:{display:"flex",flexDirection:"column",alignItems:"center"},button:{margin:20}}),de=r.a.memo(r.a.forwardRef((function(e,t){var n=e.enableNext,r=Object(a.useState)({label:"",description:""}),c=Object(o.a)(r,2),s=c[0],i=c[1],u=Object(a.useState)(!1),p=Object(o.a)(u,2),d=p[0],j=p[1],h=Object(a.useContext)(g),x=h.drawingUUIDs,v=h.mapSubscriptionKey,y=h.mapAccountName,I=h.statesetId,k=h.store,w=Object(a.useCallback)(Object(f.a)(b.a.mark((function e(){var t,a,r,c,s,o,u,l,p,d,m,f,h;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=2;break}return e.abrupt("return");case 2:a=[],j(!0),r=Object(le.a)(x),e.prev=5,r.s();case 7:if((c=r.n()).done){e.next=16;break}return s=c.value,i({label:"Converting packages. Please wait...",description:"Converting package ".concat(s.uuid)}),e.next=12,G(null===s||void 0===s?void 0:s.uuid,"us",v);case 12:(o=e.sent)&&a.push(o);case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:l=0,p=a;case 25:if(!(l<p.length)){e.next=34;break}return m=p[l],i({label:"Creating data set",description:null!==(d=u)&&void 0!==d?d:"This might take some time."}),e.next=30,L(m,"us",v,u);case 30:u=e.sent;case 31:l++,e.next=25;break;case 34:if(i({label:"Dataset created. Creating tileset ...",description:null!==(t=u)&&void 0!==t?t:""}),!u){e.next=47;break}return e.next=38,q(u,"us",v);case 38:if(f=e.sent,i({label:"Tileset created. Creating stateset ...",description:null!==f&&void 0!==f?f:""}),!f){e.next=47;break}return e.next=43,H(u,"us",v);case 43:h=e.sent,i({label:"State set created.",description:null!==h&&void 0!==h?h:""}),k({tileSetId:f,statesetId:h}),n();case 47:case"end":return e.stop()}}),e,null,[[5,18,21,24]])}))),[x,v,i,k,j,n]);return Object(a.useEffect)((function(){I&&n()}),[I,n]),I?Object(O.jsxs)("div",{className:pe.container,children:[Object(O.jsxs)("span",{children:["You already have configure your map account ",Object(O.jsx)("mark",{children:y}),"."]}),Object(O.jsx)("span",{children:'Click on the "Restart" button if you want to start another conversion, otherwise click "Next" to continue the setup.'}),Object(O.jsx)(l.a,{className:pe.button,text:"Restart",onClick:w})]}):d?Object(O.jsx)("div",{className:pe.container,children:Object(O.jsx)(se.a,Object(m.a)(Object(m.a)({},s),{},{percentComplete:I?1:void 0}))}):Object(O.jsxs)("div",{className:pe.container,children:[Object(O.jsxs)("h4",{children:["You have uploaded ",null===x||void 0===x?void 0:x.length," drawings."]}),Object(O.jsxs)("span",{children:["The packages now need to be converted and assign to a dataset. ",Object(O.jsx)("br",{}),"Click on the ",Object(O.jsx)("mark",{children:'"Start"'})," button below to start the process."]}),Object(O.jsx)("span",{children:"This may take several minutes. Please do not close this page until all required steps are completed."}),Object(O.jsx)(l.a,{className:pe.button,text:"Start",onClick:w})]})}))),be=Object(u.u)({container:{display:"flex",flexDirection:"column",alignItems:"center"},listGrid:{width:"90%",height:600,display:"flex",justifyContent:"center",alignItems:"center",gap:20,flexWrap:"wrap",overflowY:"auto"},listGridItem:{padding:5,width:200,height:180,alignItems:"center",textAlign:"center",display:"inline-flex",justifyContent:"center",border:"1px solid black"},selected:{backgroundColor:"#f3f2f1"},clickable:{"&:hover":{backgroundColor:"#FFFFFF",cursor:"pointer"}},button:{display:"flex",flexDirection:"column"},description:{margin:"5%"}}),me=r.a.memo(r.a.forwardRef((function(e,t){var n=e.enableNext,c=Object(a.useState)(null),s=Object(o.a)(c,2),i=s[0],u=s[1],l=Object(a.useState)(null),p=Object(o.a)(l,2),d=p[0],m=p[1],j=Object(a.useContext)(g),h=j.managementCredentials,x=j.subscriptionId,v=j.centralDetails,y=j.store,I=Object(a.useRef)(!1),k=Object(a.useCallback)(function(){var e=Object(f.a)(b.a.mark((function e(t,n){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=u,e.next=3,D(t,n);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[u]);Object(a.useEffect)((function(){i&&v&&m(i.findIndex((function(e){return e.subdomain===v.appUrl.split(".")[0]})))}),[i,v]),Object(a.useEffect)((function(){h&&k(h,x)}),[k,h,x]),Object(a.useEffect)((function(){null===d||I.current||(n(),I.current=!0)}),[d,n]),Object(a.useImperativeHandle)(t,(function(){return{process:function(){var e=Object(f.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(h,"".concat(i[d].subdomain,".azureiotcentral.com"));case 2:t=e.sent,console.log(t),t&&y({centralDetails:{appUrl:"".concat(i[d].subdomain,".azureiotcentral.com"),apiKey:t}});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}),[h,i,d,y]);var w=r.a.useCallback((function(e,t){return Object(O.jsx)("div",{className:"".concat(be.listGridItem," ").concat(be.clickable," ").concat(d===t?be.selected:""),onClick:function(){m(d===t?null:t)},children:Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:null===e||void 0===e?void 0:e.displayName}),Object(O.jsx)("p",{children:"https://".concat(null===e||void 0===e?void 0:e.subdomain,".azureiotcentral.com")}),d===t&&Object(O.jsx)(ce.a,{iconName:"CheckMark"})]})},"central-app-".concat(t))}),[m,d]);return i?Object(O.jsxs)("div",{className:be.container,children:[Object(O.jsx)("h2",{children:"Select IoT Central application"}),Object(O.jsx)("div",{className:be.listGrid,children:i.map(w)})]}):Object(O.jsx)("div",{className:"centered",children:Object(O.jsx)(se.a,{className:"pageload",description:"Loading IoT Central applications"})})}))),fe=me,je=Object(u.u)({container:{display:"flex",flexDirection:"column",alignItems:"center"},content:{width:"90%",display:"flex",justifyContent:"center",alignItems:"center"},button:{margin:20}}),he=r.a.memo(r.a.forwardRef((function(){var e=Object(a.useState)(!1),t=Object(o.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)({label:"Creating web site",description:"This might take a while. Please don't close the page until creation is completed."}),s=Object(o.a)(c,1)[0],i=Object(a.useContext)(g),u=i.managementCredentials,p=i.subscriptionId,d=i.resourceGroup,j=i.mapSubscriptionKey,h=i.tileSetId,x=i.statesetId,v=i.centralDetails,y=i.centerCoordinates,I=i.siteUrl,k=i.store,w=Object(a.useCallback)(Object(f.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k({siteUrl:void 0}),r(!0),e.next=4,$(u,p,d,{iotcApiKey:null===v||void 0===v?void 0:v.apiKey,iotcAppUrl:null===v||void 0===v?void 0:v.appUrl,mapSubscriptionKey:j,mapTilesetId:h,mapStatesetId:x,mapLatitude:y?"".concat(y[0]):"",mapLongitude:y?"".concat(y[1]):""});case 4:(t=e.sent)&&k({siteUrl:t});case 6:case"end":return e.stop()}}),e)}))),[v,y,u,p,d,j,h,x,r,k]);return I?Object(O.jsxs)("div",{className:je.container,children:[Object(O.jsx)("h2",{children:"Congratulations!!"}),Object(O.jsx)("h4",{children:"Your website is available here:"}),Object(O.jsx)("a",{href:I,children:I}),Object(O.jsx)("span",{children:"Would you like to publish your site again?"}),Object(O.jsx)("span",{children:'Click on the "Re-Publish" button below if your previous attempts failed.'}),Object(O.jsx)(l.a,{className:je.button,text:"Re-publish",onClick:Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)})))})]}):n?Object(O.jsx)("div",{className:je.container,children:Object(O.jsx)(se.a,Object(m.a)({},s))}):Object(O.jsxs)("div",{className:je.container,children:[Object(O.jsx)("span",{children:"All required configuration steps are completed."}),Object(O.jsx)("span",{children:'Click on the "Publish" button below to start publishing the website which will serve your map.'}),Object(O.jsx)(l.a,{className:je.button,text:"Publish",onClick:Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)})))})]})}))),Oe=Object(u.u)({wizardBody:{display:"flex",justifyContent:"center",textAlign:"center",alignItems:"center",flexDirection:"column"},footer:{marginBottom:10,display:"flex",alignItems:"center",justifyContent:"space-between",width:"80%",marginTop:10},arrow:{alignItems:"center",display:"flex",width:100,justifyContent:"space-evenly"},icon:{cursor:"pointer"},content:{display:"flex",flexDirection:"column",justifyConten:"center",textAlign:"center",alignItems:"center",overflowY:"auto",height:"90%",justifyContent:"center"}});function xe(){var e=function(e){var t=Object(a.useState)(e||0),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useCallback)((function(){c((function(e){return e+1}))}),[c]),i=Object(a.useCallback)((function(){c((function(e){return e-1}))}),[c]);return[r,s,i]}(0),t=Object(o.a)(e,3),n=t[0],r=t[1],c=t[2],s=Object(a.useState)(!1),i=Object(o.a)(s,2),u=i[0],p=i[1],d=[Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useRef)(null),Object(a.useRef)(null)];return Object(O.jsxs)("div",{className:Oe.wizardBody,children:[Object(O.jsx)("div",{className:Oe.content,children:function(e){switch(e){case 0:return Object(O.jsx)(ae,{ref:d[0],enableNext:function(){return p(!0)}});case 1:return Object(O.jsx)(ue,{ref:d[1],enableNext:function(){return p(!0)}});case 2:return Object(O.jsx)(de,{ref:d[2],enableNext:function(){return p(!0)}});case 3:return Object(O.jsx)(fe,{ref:d[3],enableNext:function(){return p(!0)}});case 4:return Object(O.jsx)(he,{ref:d[4],enableNext:function(){return p(!0)}});default:return null}}(n)}),Object(O.jsxs)("div",{className:Oe.footer,children:[Object(O.jsx)(l.a,{primary:!0,text:"Previous",iconProps:{iconName:"Back"},onClick:c,style:0===n?{visibility:"hidden"}:{}}),Object(O.jsx)(l.a,{primary:!0,text:"Next",iconProps:{iconName:"Forward"},disabled:4===n||!u,onClick:function(){var e;null===(e=d[n].current)||void 0===e||e.process(),r(),p(!1)}})]})]})}var ge=r.a.memo((function(){return Object(O.jsx)(y,{children:Object(O.jsx)(xe,{})})})),ve=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,183)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};Object(i.a)(),s.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(ge,{})}),document.getElementById("root")),ve()},72:function(e){e.exports=JSON.parse('{"$schema":"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"gitRepo":{"type":"string","metadata":{"description":"The name of the git repository containing the website code."}},"gitBranch":{"type":"string","defaultValue":"","metadata":{"description":"The name of the git repository branch containing the website code if different from default"}},"siteFolder":{"type":"string","metadata":{"description":"The website folder in the git repository"}},"scriptUri":{"type":"string","metadata":{"description":"Url of the deployment script"}},"mapSubscriptionKey":{"type":"string","metadata":{"description":"The azure map subscription key"}},"mapLatitude":{"type":"string","defaultValue":"","metadata":{"description":"The map center latitude"}},"mapLongitude":{"type":"string","defaultValue":"","metadata":{"description":"The map center longitude"}},"mapTilesetId":{"type":"string","metadata":{"description":"The map tileset Id"}},"mapStatesetId":{"type":"string","metadata":{"description":"The map stateset Id"}},"iotcApiKey":{"type":"string","metadata":{"description":"The IoTCentral Api Key"}},"iotcAppUrl":{"type":"string","metadata":{"description":"The IoTCentral App url"}}},"variables":{"storageContributorId":"17d1049b-9a84-46fb-8f53-869881c3d3ab","storageName":"[concat(\'iotcindsa\',uniqueString(resourceGroup().id))]"},"resources":[{"type":"Microsoft.Storage/storageAccounts","apiVersion":"2021-04-01","name":"[variables(\'storageName\')]","location":"[resourceGroup().location]","kind":"StorageV2","sku":{"name":"Standard_LRS"}},{"type":"Microsoft.ManagedIdentity/userAssignedIdentities","apiVersion":"2018-11-30","name":"DeploymentScript","location":"[resourceGroup().location]"},{"type":"Microsoft.Authorization/roleAssignments","apiVersion":"2020-04-01-preview","scope":"[format(\'Microsoft.Storage/storageAccounts/{0}\', variables(\'storageName\'))]","name":"[guid(resourceGroup().id, resourceId(\'Microsoft.ManagedIdentity/userAssignedIdentities\', \'DeploymentScript\'), subscriptionResourceId(\'Microsoft.Authorization/roleDefinitions\', variables(\'storageContributorId\')))]","properties":{"roleDefinitionId":"[subscriptionResourceId(\'Microsoft.Authorization/roleDefinitions\', variables(\'storageContributorId\'))]","principalId":"[reference(resourceId(\'Microsoft.ManagedIdentity/userAssignedIdentities\', \'DeploymentScript\')).principalId]","principalType":"ServicePrincipal"},"dependsOn":["[resourceId(\'Microsoft.ManagedIdentity/userAssignedIdentities\', \'DeploymentScript\')]","[resourceId(\'Microsoft.Storage/storageAccounts\', variables(\'storageName\'))]"]},{"type":"Microsoft.Resources/deploymentScripts","apiVersion":"2020-10-01","name":"deploymentScript","location":"[resourceGroup().location]","kind":"AzureCLI","identity":{"type":"UserAssigned","userAssignedIdentities":{"[resourceId(\'Microsoft.ManagedIdentity/userAssignedIdentities\', \'DeploymentScript\')]":{}}},"properties":{"primaryScriptUri":"[parameters(\'scriptUri\')]","azCliVersion":"2.28.0","storageAccountSettings":{"storageAccountName":"[variables(\'storageName\')]","storageAccountKey":"[listKeys(resourceId(\'Microsoft.Storage/storageAccounts\',variables(\'storageName\')),\'2021-04-01\').keys[0].value]"},"retentionInterval":"PT4H","environmentVariables":[{"name":"RESOURCE_GROUP_NAME","value":"[resourceGroup().name]"},{"name":"STORAGE_ACCOUNT_NAME","value":"[variables(\'storageName\')]"},{"name":"GIT_REPO","value":"[parameters(\'gitRepo\')]"},{"name":"GIT_BRANCH","value":"[parameters(\'gitBranch\')]"},{"name":"SITE_FOLDER","value":"[parameters(\'siteFolder\')]"},{"name":"REACT_APP_MAP_SUBSCRIPTION_KEY","value":"[parameters(\'mapSubscriptionKey\')]"},{"name":"REACT_APP_MAP_LAT","value":"[parameters(\'mapLatitude\')]"},{"name":"REACT_APP_MAP_LON","value":"[parameters(\'mapLongitude\')]"},{"name":"REACT_APP_MAP_TILESET_ID","value":"[parameters(\'mapTilesetId\')]"},{"name":"REACT_APP_MAP_STATESET_ID","value":"[parameters(\'mapStatesetId\')]"},{"name":"REACT_APP_IOTC_API_KEY","value":"[parameters(\'iotcApiKey\')]"},{"name":"REACT_APP_IOTC_APP_URL","value":"[parameters(\'iotcAppUrl\')]"}]},"dependsOn":["[resourceId(\'Microsoft.ManagedIdentity/userAssignedIdentities\', \'DeploymentScript\')]","[extensionResourceId(resourceId(\'Microsoft.Storage/storageAccounts\', variables(\'storageName\')), \'Microsoft.Authorization/roleAssignments\', guid(resourceGroup().id, resourceId(\'Microsoft.ManagedIdentity/userAssignedIdentities\', \'DeploymentScript\'), subscriptionResourceId(\'Microsoft.Authorization/roleDefinitions\', variables(\'storageContributorId\'))))]","[resourceId(\'Microsoft.Storage/storageAccounts\', variables(\'storageName\'))]"]}],"outputs":{"staticWebsiteUrl":{"type":"string","value":"[reference(resourceId(\'Microsoft.Storage/storageAccounts\',variables(\'storageName\'))).primaryEndpoints.web]"}}}')}},[[130,1,2]]]);
//# sourceMappingURL=main.67f238fb.chunk.js.map