(this.webpackJsonpsetup=this.webpackJsonpsetup||[]).push([[0],{101:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(51),s=n.n(c),i=n(58),o=(n(77),n(11)),u=n(4),l=n(62);function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1024,a=t<0?0:t,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],c=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,c)).toFixed(a))+" "+r[c]}var p=n(8),d=n(134),f=n(3),j={subscriptionId:null,tenantId:null,mapSubscriptionKey:null,drawingUUIDs:null,tileSetId:null,statesetId:null},m=r.a.createContext({}),h=m.Provider,v=function(e){var t=e.children,n=Object(a.useState)(j),r=Object(o.a)(n,2),c=r[0],s=r[1],i=Object(a.useCallback)((function(e){s((function(t){return Object(p.a)(Object(p.a)({},t),e)}))}),[s]),u=Object(p.a)(Object(p.a)({},c),{},{store:i});return Object(f.jsx)(h,{value:u,children:t})},x=r.a.memo((function(e){var t=e.visible,n=e.enableNext,r=e.submit,c=e.resetSubmit,s=Object(a.useContext)(m),i=s.store,u=(s.subscriptionId,s.tenantId,s.mapSubscriptionKey,Object(a.useState)({subscriptionId:"7c989b7d-a7d5-4256-9f3f-809d6554cec8",tenantId:"72f988bf-86f1-41af-91ab-2d7cd011db47",mapSubscriptionKey:"fzIwvA-PX2RNMM0P_9SoCSZHvX3iFD2712Qemctrqwk"})),l=Object(o.a)(u,2),b=l[0],j=l[1],h=Object(a.useRef)(!1);return Object(a.useEffect)((function(){r&&(c(),i(b))}),[r,c,i,b]),Object(a.useEffect)((function(){b.subscriptionId&&b.tenantId&&b.mapSubscriptionKey&&!h.current&&(n(),h.current=!0)}),[b,n]),t?Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:"Deploy Maps account to your Azure Subscription"}),Object(f.jsx)("p",{children:"Click on the button below to deploy the solution to your azure subscription."}),Object(f.jsx)("a",{href:"https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Flucadruda%2Fubs-workshop%2Findoor_maps%2Fsetup%2Fazure%2Fazuredeploy.json%3Ftoken%3DAARKIISFGX2MRU7JK7VOZXTBNFEMQ",target:"_blank",children:Object(f.jsx)("img",{src:"https://aka.ms/deploytoazurebutton"})}),Object(f.jsx)("div",{}),Object(f.jsxs)("div",{style:{textAlign:"start"},children:[Object(f.jsx)(d.a,{label:"Subscription Id",value:b.subscriptionId,onChange:function(e,t){j((function(e){return Object(p.a)(Object(p.a)({},e),{},{subscriptionId:t})}))}}),Object(f.jsx)(d.a,{label:"Tenant Id",value:b.tenantId,onChange:function(e,t){j((function(e){return Object(p.a)(Object(p.a)({},e),{},{tenantId:t})}))}}),Object(f.jsx)(d.a,{label:"Map Subscription Key",value:b.mapSubscriptionKey,onChange:function(e,t){j((function(e){return Object(p.a)(Object(p.a)({},e),{},{mapSubscriptionKey:t})}))}})]})]}):null})),O=n(60),y=n(2),g=n.n(y),k=n(5),w=n(135),I=n(137),F=n(59),C=(n(57),n(133),n(21)),S=n.n(C),N="2.0";function B(e,t,n,a){return D.apply(this,arguments)}function D(){return(D=Object(k.a)(g.a.mark((function e(t,n,a,r){var c,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=0,e.next=3,S.a.post("https://".concat(n,".atlas.microsoft.com/mapData?api-version=").concat(N,"&dataFormat=dwgzippackage&subscription-key=").concat(a),t,{headers:{"Content-Type":"application/octet-stream"}});case 3:if(s=e.sent,r(c+=.1),!s.headers["operation-location"]){e.next=9;break}return e.next=8,U("".concat(s.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=e.headers["resource-location"].match(/https:\/\/us\.atlas\.microsoft\.com\/mapData\/metadata\/([\S]+)\?api-version=2\.0/);return t&&2===t.length?t[1]:null}),r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n){return z.apply(this,arguments)}function z(){return(z=Object(k.a)(g.a.mark((function e(t,n,a){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("https://".concat(n,".atlas.microsoft.com/conversions?api-version=").concat(N,"&udid=").concat(t,"&inputType=DWG&subscription-key=").concat(a,"&outputOntology=facility-2.0"));case 2:if(!(r=e.sent).headers["operation-location"]){e.next=7;break}return e.next=6,U("".concat(r.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=new RegExp("https://".concat(n,".atlas.microsoft.com/conversions/([\\S]+)\\?api-version=").concat(N)),a=e.headers["resource-location"].match(t);return a&&2===a.length?a[1]:null}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t,n,a){return E.apply(this,arguments)}function E(){return(E=Object(k.a)(g.a.mark((function e(t,n,a,r){var c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("https://".concat(n,".atlas.microsoft.com/datasets?api-version=").concat(N,"&conversionId=").concat(t,"&subscription-key=").concat(a).concat(r?"&datasetId=".concat(r):""));case 2:if(!(c=e.sent).headers["operation-location"]){e.next=7;break}return e.next=6,U("".concat(c.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=new RegExp("https://".concat(n,".atlas.microsoft.com/datasets/([\\S]+)\\?api-version=").concat(N)),a=e.headers["resource-location"].match(t);return a&&2===a.length?a[1]:null}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t,n){return P.apply(this,arguments)}function P(){return(P=Object(k.a)(g.a.mark((function e(t,n,a){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("https://".concat(n,".atlas.microsoft.com/tilesets?api-version=").concat(N,"&datasetID=").concat(t,"&subscription-key=").concat(a));case 2:if(!(r=e.sent).headers["operation-location"]){e.next=7;break}return e.next=6,U("".concat(r.headers["operation-location"],"&subscription-key=").concat(a),{body:"status",header:"resource-location"},(function(e){var t=new RegExp("https://".concat(n,".atlas.microsoft.com/tilesets/([\\S]+)\\?api-version=").concat(N)),a=e.headers["resource-location"].match(t);return a&&2===a.length?a[1]:null}));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t,n){return R.apply(this,arguments)}function R(){return(R=Object(k.a)(g.a.mark((function e(t,n,a){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("https://".concat(n,".atlas.microsoft.com/featurestatesets?api-version=").concat(N,"&datasetId=").concat(t,"&subscription-key=").concat(a),{styles:[{keyName:"occupied",type:"boolean",rules:[{true:"#8e5a00",false:"#FFFFFF"}]},{keyName:"temperature",type:"number",rules:[{range:{minimum:"13",exclusiveMaximum:"18"},color:"#0000FF"},{range:{minimum:"24"},color:"#FF0000"},{range:{minimum:"18",exclusiveMaximum:"24"},color:"#00FF00"}]}]},{headers:{"Content-Type":"application/json"}});case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data.statesetId);case 5:return e.abrupt("return",null);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t,n,a){return G.apply(this,arguments)}function G(){return(G=Object(k.a)(g.a.mark((function e(t,n,a,r){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){var s=0,i=setInterval(Object(k.a)(g.a.mark((function o(){var u,l;return g.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return null===r||void 0===r||r(s+=.1),o.prev=1,o.next=4,S.a.get(t);case 4:200===(u=o.sent).status&&(n.body&&"Succeeded"===u.data[n.body]||n.header&&u.headers[n.header])&&(clearInterval(i),null===r||void 0===r||r(1),(l=a(u))?e(l):c(l)),o.next=11;break;case 8:o.prev=8,o.t0=o.catch(1),c();case 11:case"end":return o.stop()}}),o,null,[[1,8]])}))),5e3)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var X=Object(u.l)({listGrid:{width:"90%",display:"flex",justifyContent:"center",alignItems:"center",gap:20},listGridItem:{padding:5,width:200,height:180,alignItems:"center",textAlign:"center",display:"inline-flex",justifyContent:"center",border:"1px solid black"},clickable:{backgroundColor:"#f3f2f1","&:hover":{backgroundColor:"#FFFFFF",cursor:"pointer"}},button:{display:"flex",flexDirection:"column"}}),J=r.a.memo((function(e){var t=e.visible,n=e.enableNext,c=e.submit,s=e.resetSubmit,i=Object(a.useState)([null]),u=Object(o.a)(i,2),l=u[0],d=u[1],j=Object(a.useContext)(m),h=j.mapSubscriptionKey,v=j.store,x=Object(a.useRef)(!1),y=Object(a.useCallback)((function(e){e.forEach((function(e){var t=new FileReader;t.onload=Object(k.a)(g.a.mark((function n(){var a;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,B(t.result,"us",h,(function(t){d((function(n){return n.map((function(n){return(null===n||void 0===n?void 0:n.name)===e.name?Object(p.a)(Object(p.a)({},n),{},{progress:t}):n}))}))}));case 2:(a=n.sent)&&d((function(t){return t.map((function(t){return(null===t||void 0===t?void 0:t.name)===e.name?Object(p.a)(Object(p.a)({},t),{},{uuid:a}):t}))}));case 4:case"end":return n.stop()}}),n)}))),t.readAsArrayBuffer(e),d((function(t){return[{name:e.name,size:b(e.size),progress:0}].concat(Object(O.a)(t))}))}))}),[d,h]),C=Object(F.a)({onDrop:y,maxFiles:1,accept:".zip"}),S=C.getRootProps,N=C.getInputProps;C.isDragActive;Object(a.useEffect)((function(){c&&(s(),v({drawingUUIDs:l.filter((function(e){return null===e||void 0===e?void 0:e.uuid})).map((function(e){return null===e||void 0===e?void 0:e.uuid}))}))}),[c,s,v,l]),Object(a.useEffect)((function(){l.length>1&&!x.current&&(n(),x.current=!0)}),[l,n]);var D=r.a.useCallback((function(e,t){var n;return Object(f.jsx)("div",{className:"".concat(X.listGridItem," ").concat(null===e?X.clickable:""),children:null===e?Object(f.jsxs)("div",Object(p.a)(Object(p.a)({},S()),{},{children:[Object(f.jsx)("input",Object(p.a)({},N())),Object(f.jsxs)("div",{className:X.button,children:[Object(f.jsx)(w.a,{iconName:"AddIn"}),Object(f.jsx)("h3",{children:"Add a drawing"})]})]})):Object(f.jsxs)("div",{children:[Object(f.jsx)("h2",{children:e.name}),Object(f.jsx)(I.a,{label:e.progress<1?"Uploading package...":"Package ready.",description:null!==(n=e.uuid)&&void 0!==n?n:"",percentComplete:e.progress,progressHidden:1===e.progress}),Object(f.jsx)("h3",{children:e.size})]})},"upload-b-".concat(t))}),[N,S]);return t?h?Object(f.jsx)("div",{className:X.listGrid,children:l.map(D)}):Object(f.jsx)("div",{children:"loading"}):null})),Z=n(19),_=Object(u.l)({content:{width:"90%",display:"flex",justifyContent:"center",alignItems:"center"}}),H=r.a.memo((function(e){var t=e.visible,n=Object(a.useState)({label:"",description:""}),r=Object(o.a)(n,2),c=r[0],s=r[1],i=Object(a.useContext)(m),u=i.drawingUUIDs,l=i.mapSubscriptionKey,b=i.store,d=Object(a.useCallback)(Object(k.a)(g.a.mark((function e(){var t,n,a,r,c,i,o,p,d,f,j,m,h;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u){e.next=2;break}return e.abrupt("return");case 2:n=[],a=Object(Z.a)(u),e.prev=4,a.s();case 6:if((r=a.n()).done){e.next=15;break}return c=r.value,s({label:"Converting packages",description:"Converting package ".concat(c)}),e.next=11,M(c,"us",l);case 11:(i=e.sent)&&n.push(i);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:p=0,d=n;case 24:if(!(p<d.length)){e.next=33;break}return j=d[p],s({label:"Creating data set",description:null!==(f=o)&&void 0!==f?f:"This might take some time."}),e.next=29,A(j,"us",l,o);case 29:o=e.sent;case 30:p++,e.next=24;break;case 33:if(s({label:"Dataset created. Creating tileset ...",description:null!==(t=o)&&void 0!==t?t:""}),!o){e.next=45;break}return e.next=37,K(o,"us",l);case 37:if(m=e.sent,s({label:"Tileset created. Creating stateset ...",description:null!==m&&void 0!==m?m:""}),!m){e.next=45;break}return e.next=42,T(o,"us",l);case 42:h=e.sent,s({label:"State set created.",description:null!==h&&void 0!==h?h:""}),b({tileSetId:m,statesetId:h});case 45:case"end":return e.stop()}}),e,null,[[4,17,20,23]])}))),[u,l,s,M]);return Object(a.useEffect)((function(){d()}),[d]),t?Object(f.jsx)("div",{className:_.content,children:Object(f.jsx)(I.a,Object(p.a)({},c))}):null})),L=Object(u.l)({wizardBody:{display:"flex",justifyContent:"center",textAlign:"center"},footer:{position:"absolute",bottom:"5%",display:"flex",justifyContent:"space-evenly",width:"100%"},arrow:{alignItems:"center",display:"flex",width:100,justifyContent:"space-evenly"},icon:{cursor:"pointer"}});function Q(){var e=function(e){var t=Object(a.useState)(e||0),n=Object(o.a)(t,2),r=n[0],c=n[1];return[r,Object(a.useCallback)((function(){c((function(e){return e+1}))}),[c]),Object(a.useCallback)((function(){c((function(e){return e-1}))}),[c])]}(0),t=Object(o.a)(e,3),n=t[0],r=t[1],c=t[2],s=Object(a.useState)(!1),i=Object(o.a)(s,2),u=i[0],b=i[1],p=function(e){var t=Object(a.useState)(e),n=Object(o.a)(t,2),r=n[0],c=n[1],s=Object(a.useCallback)((function(){c(!1)}),[c]);return{submitting:r,set:Object(a.useCallback)((function(){c(!0)}),[c]),reset:s}}(!1);return Object(f.jsxs)("div",{className:L.wizardBody,children:[Object(f.jsx)(x,{visible:0===n,enableNext:function(){return b(!0)},submit:p.submitting&&1===n,resetSubmit:p.reset}),Object(f.jsx)(J,{visible:1===n,enableNext:function(){return b(!0)},submit:p.submitting&&2===n,resetSubmit:p.reset}),Object(f.jsx)(H,{visible:2===n,enableNext:function(){return b(!0)},submit:p.submitting&&3===n,resetSubmit:p.reset}),Object(f.jsxs)("div",{className:L.footer,children:[Object(f.jsxs)("div",{className:L.arrow,style:{display:0===n?"none":"flex"},children:[Object(f.jsx)("p",{children:"Previous"}),Object(f.jsx)(l.a,{iconName:"Back",onClick:c,className:L.icon})]}),Object(f.jsxs)("div",{className:L.arrow,style:{display:2!==n&&u?"flex":"none"},children:[Object(f.jsx)("p",{children:"Next"}),Object(f.jsx)(l.a,{iconName:"Forward",onClick:function(){r(),p.set()},className:L.icon})]})]})]})}var q=r.a.memo((function(){return Object(f.jsx)(v,{children:Object(f.jsx)(Q,{})})})),V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,138)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};Object(i.a)(),s.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(q,{})}),document.getElementById("root")),V()},77:function(e,t,n){}},[[101,1,2]]]);
//# sourceMappingURL=main.2c5e5bda.chunk.js.map