{"version":3,"sources":["common.ts","icons/tv.png","icons/thermostat.png","central.ts","Cards.tsx","map.ts","App.tsx","reportWebVitals.js","index.js"],"names":["CardActionType","APP_URL","window","REACT_APP_IOTC_APP_URL","process","API_VERSION","API_KEY","REACT_APP_IOTC_API_KEY","MAP_SUBSCRIPTION_KEY","REACT_APP_MAP_SUBSCRIPTION_KEY","MAP_STATESET_ID","REACT_APP_MAP_STATESET_ID","MAP_TILESET_ID","REACT_APP_MAP_TILESET_ID","MAP_LAT","REACT_APP_MAP_DATASET_ID","REACT_APP_MAP_LAT","MAP_LON","REACT_APP_MAP_LON","getRandomPosition","feature","pos","geometry","coordinates","Math","random","FEATURE_MAP","undefined","CIRC201","CIRC202","CIRC203","B47","B45","B43","B41","B39","B37","B36","B38","B40","B42","B44","B46","B06","B05","B01","B15","B13","B11","B17","B19","B21","B23","B25","B49","B48","B53","B55","B57","B56","B51","B50","B52","B54","B16","B12","B14","B18","B20","B22","B24","B26","B08","B07","B10","B09","CIRCB01","CIRCB02","CIRCB03","B04","B03","B02","CIRC101","CIRC102","CIRC103","TV_MODEL","THM_MODEL","getDevices","a","res","tv","thermostats","axios","get","method","headers","Authorization","devs","includes","status","data","value","filter","d","template","Promise","all","map","etag","getDeviceProperties","id","properties","thm","deviceId","props","getTelemetryValue","telemetryName","triggerCommand","commandName","commandPayload","post","setProperty","propertyName","propertyValue","patch","classNames","mergeStyleSets","compactCard","display","flexDirection","alignItems","justifyContent","height","expandedCard","padding","list","width","item","marginBottom","selectors","textDecoration","cursor","onRenderListItem","index","className","Text","style","fontWeight","key","onEdit","TextField","type","onChange","e","val","TvCard","React","memo","useState","currentPower","setCurrentPower","fetchTelemetry","useCallback","useEffect","items","useMemo","ipaddress","List","onRenderCell","PrimaryButton","text","onClick","ThermostatCard","currentTemperature","setCurrentTemperature","targetTemperature","setTargetTemperature","parseInt","setFeatureState","roomId","keyName","states","eventTimestamp","Date","toISOString","put","statusText","response","mapId","App","useReducer","state","action","OPEN","payload","show","DISMISS","event","pagePosition","dispatch","open","dismiss","useCard","cardState","openCard","devices","setDevices","tvDataSource","useRef","atlas","DataSource","current","thermostatDataSource","features","setFeatures","labelId","useId","descriptionId","popupRef","cardIcon","onMouseOver","layer","layers","getRenderedShapes","position","forEach","dataSource","getId","featureId","getX","pixel","getY","focus","refresh","length","newState","room","isEqual","clear","find","name","add","Feature","Point","displayName","ipAddress","maxTempSinceLastReboot","inId","setInterval","clearInterval","indoorMap","center","view","authOptions","authType","subscriptionKey","zoom","events","levelControl","control","LevelControl","TopRight","indoorManager","indoor","IndoorManager","tilesetId","statesetId","setDynamicStyling","eventData","console","log","endsWith","imageSprite","TvIcon","ThermostatIcon","sources","tvsLayer","SymbolLayer","minZoom","iconOptions","image","size","thmsLayer","ex","onRenderExpandedCard","onRenderCompactCard","src","alt","block","variant","styles","title","expandingCardProps","renderData","directionalHint","DirectionalHint","rightTopEdge","gapSpace","calloutProps","isBeakVisible","left","top","HoverCard","cardDismissDelay","trapFocus","sticky","instantOpenOnClick","button","card","FontWeights","bold","link","marginTop","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.11760035.chunk.js","sourcesContent":["import { data } from \"azure-maps-control\";\nimport { useCallback, useReducer } from \"react\";\n\nexport const APP_URL =\n  window.REACT_APP_IOTC_APP_URL ||\n  process.env[\"REACT_APP_IOTC_APP_URL\"] ||\n  \"\";\nexport const API_VERSION = \"1.0\";\nexport const API_KEY =\n  window.REACT_APP_IOTC_API_KEY || process.env[\"REACT_APP_IOTC_API_KEY\"] || \"\";\nexport const MAP_SUBSCRIPTION_KEY =\n  window.REACT_APP_MAP_SUBSCRIPTION_KEY ||\n  process.env[\"REACT_APP_MAP_SUBSCRIPTION_KEY\"] ||\n  \"\";\nexport const MAP_STATESET_ID =\n  window.REACT_APP_MAP_STATESET_ID ||\n  process.env[\"REACT_APP_MAP_STATESET_ID\"] ||\n  \"\";\nexport const MAP_TILESET_ID =\n  window.REACT_APP_MAP_TILESET_ID || process.env[\"REACT_APP_MAP_TILESET_ID\"] || \"\";\n\n  export const MAP_DATASET_ID =\n  window.REACT_APP_MAP_DATASET_ID || process.env[\"REACT_APP_MAP_DATASET_ID\"] || \"\";\n\nexport const MAP_LAT =\n  window.REACT_APP_MAP_LAT ||\n  process.env[\"REACT_APP_MAP_LAT\"] ||\n  46.946908419572395;\nexport const MAP_LON =\n  window.REACT_APP_MAP_LON ||\n  process.env[\"REACT_APP_MAP_LON\"] ||\n  7.446113203345874;\n\ntype Feature = data.Feature<data.Geometry, any>;\n\nenum CardActionType {\n  OPEN = \"OPEN\",\n  DISMISS = \"DISMISS\",\n}\ntype CardActions = {\n  type: CardActionType;\n  payload?: Partial<CardState>;\n};\ntype CardState = {\n  id: string | null;\n  data: any | null;\n  pagePosition: [number, number] | null;\n  show: boolean;\n};\ntype CardItems = {\n  open: (id: string, data: any, pagePosition: [number, number]) => void;\n  dismiss: () => void;\n  state: CardState;\n};\n\nexport function useCard(): CardItems {\n  const reducer = (state: CardState, action: CardActions) => {\n    switch (action.type) {\n      case CardActionType.OPEN:\n        return { ...state, ...action.payload, show: true };\n      case CardActionType.DISMISS:\n        return { ...state, id: null, data: null, event: null, show: false };\n      default:\n        return state;\n    }\n  };\n\n  const [state, dispatch] = useReducer(reducer, {\n    id: null,\n    data: null,\n    pagePosition: null,\n    show: false,\n  });\n\n  const open = useCallback(\n    (id: string, data: any, pagePosition: [number, number]) => {\n      dispatch({\n        type: CardActionType.OPEN,\n        payload: { id, data, pagePosition },\n      });\n    },\n    [dispatch]\n  );\n\n  const dismiss = useCallback(() => {\n    dispatch({\n      type: CardActionType.DISMISS,\n    });\n  }, []);\n  return { open, dismiss, state };\n}\n\nexport function getRandomPosition(feature: Feature): [number, number] {\n  const pos = feature.geometry.coordinates[0] as data.Position[];\n  return [\n    Math.random() * (pos[0][0] - pos[2][0]) + pos[2][0],\n    Math.random() * (pos[0][1] - pos[1][1]) + pos[1][1],\n  ];\n}\n\n\nexport const FEATURE_MAP = {\n  \"201\": 122,\n  \"202\": 119,\n  \"203\": 118,\n  \"204\": 117,\n  \"205\": 116,\n  \"206\": 115,\n  \"207\": 112,\n  \"208\": 111,\n  \"209\": 114,\n  \"210\": 113,\n  \"211\": 123,\n  \"212\": 104,\n  \"213\": 121,\n  \"214\": 105,\n  \"215\": 120,\n  \"216\": 103,\n  \"217\": 124,\n  \"218\": 106,\n  \"219\": 125,\n  \"220\": 107,\n  \"221\": 126,\n  \"222\": 108,\n  \"223\": 127,\n  \"224\": 109,\n  \"225\": 128,\n  \"226\": 110,\n  \"236\": 97,\n  \"237\": 96,\n  \"238\": 98,\n  \"239\": 95,\n  \"240\": 99,\n  \"241\": 94,\n  \"242\": 100,\n  \"243\": 93,\n  \"244\": 101,\n  \"245\": 92,\n  \"246\": 102,\n  \"247\": 91,\n  \"248\": 82,\n  \"249\": 81,\n  \"250\": 88,\n  \"251\": 87,\n  \"252\": 89,\n  \"253\": 83,\n  \"254\": 90,\n  \"255\": 84,\n  \"256\": 86,\n  \"257\": 85,\n  undefined: 79,\n  CIRC201: 78,\n  CIRC202: 80,\n  CIRC203: 79,\n  B47: 152,\n  B45: 153,\n  B43: 154,\n  B41: 155,\n  B39: 156,\n  B37: 157,\n  B36: 158,\n  B38: 159,\n  B40: 160,\n  B42: 161,\n  B44: 162,\n  B46: 163,\n  B06: 176,\n  B05: 177,\n  B01: 178,\n  B15: 182,\n  B13: 183,\n  B11: 184,\n  B17: 185,\n  B19: 186,\n  B21: 187,\n  B23: 188,\n  B25: 189,\n  B49: 142,\n  B48: 143,\n  B53: 144,\n  B55: 145,\n  B57: 146,\n  B56: 147,\n  B51: 148,\n  B50: 149,\n  B52: 150,\n  B54: 151,\n  B16: 164,\n  B12: 165,\n  B14: 166,\n  B18: 167,\n  B20: 168,\n  B22: 169,\n  B24: 170,\n  B26: 171,\n  B08: 172,\n  B07: 173,\n  B10: 174,\n  B09: 175,\n  CIRCB01: 139,\n  CIRCB02: 141,\n  CIRCB03: 140,\n  B04: 179,\n  B03: 180,\n  B02: 181,\n  \"101\": 61,\n  \"102\": 58,\n  \"103\": 57,\n  \"104\": 56,\n  \"105\": 55,\n  \"106\": 54,\n  \"107\": 51,\n  \"108\": 50,\n  \"109\": 53,\n  \"110\": 52,\n  \"111\": 62,\n  \"112\": 43,\n  \"113\": 60,\n  \"114\": 44,\n  \"115\": 59,\n  \"116\": 42,\n  \"117\": 63,\n  \"118\": 45,\n  \"119\": 64,\n  \"120\": 46,\n  \"121\": 65,\n  \"122\": 47,\n  \"123\": 66,\n  \"124\": 48,\n  \"125\": 67,\n  \"126\": 49,\n  \"136\": 36,\n  \"137\": 35,\n  \"138\": 37,\n  \"139\": 34,\n  \"140\": 38,\n  \"141\": 33,\n  \"142\": 39,\n  \"143\": 32,\n  \"144\": 40,\n  \"145\": 31,\n  \"146\": 41,\n  \"147\": 30,\n  \"148\": 21,\n  \"149\": 20,\n  \"150\": 27,\n  \"151\": 26,\n  \"152\": 28,\n  \"153\": 22,\n  \"154\": 29,\n  \"155\": 23,\n  \"156\": 25,\n  \"157\": 24,\n  CIRC101: 17,\n  CIRC102: 19,\n  CIRC103: 18,\n};","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAQAAABpN6lAAAABgUlEQVR42u3cu5LCQAwFUf+1UkL+GgKKAnZ5eV7o6nY7c3jKZWsUeNuIiIiIiIiIyK+T+QUAAAAAAAAAANzdMJt7AAAAAAAAAACAvADRO+joPwHhDtBHUOQdEO4A7QSFvgLhDtBGUGwOCHeA/QQFJ8FwB9hHUPQsEO4A3xMUPg2GO8B3BMX3AeEO8JnAYCMU7gDvCUx2guEO8JrAaCsc7gDPCawAnhGYAfwnsAP4S2AI8EhgCXBPYApwI7AFuBIYA1wIrAG27dAPcCxGshvgVIygAaAWQRNAJYJGgDoEzQBVCDoAahB0AVQg6ATQJ+gGUCcYAKBNMARAmWAQgC7BMABVgoEAmgRDARQJBgPoEQwHUCOYAKBFMAVAiWASgA7BNAAVgokAGgRTARQIJgPkJ5gOkJ1gAUBugiUAmQkWAeQlWAaQlWAhQE6CpQAZCfiBAgAAAAAAAAAAwA8VAQAAAAAAAACAnw8iboMYAAAAAAAAAFQCsBtkAAAAAAAAAKAMwBm4xm2nbahFGgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,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\"","import axios from \"axios\";\nimport { Device, IoTCDevice } from \"./types\";\nimport { API_KEY, API_VERSION, APP_URL } from \"./common\";\nconst TV_MODEL = \"dtmi:modelDefinition:ndexursjf:eie12urydm\";\nconst THM_MODEL = \"dtmi:modelDefinition:frfn3tauo:xwmfyixfc5\";\n\nexport async function getDevices() {\n  const res: {\n    tv: Device[];\n    thermostats: Device[];\n  } = {\n    tv: [],\n    thermostats: [],\n  };\n  const devs = await axios.get<{ value: IoTCDevice[] }>(\n    `https://${APP_URL}/api/devices?api-version=${API_VERSION}`,\n    {\n      method: \"GET\",\n      headers: {\n        Authorization: API_KEY,\n      },\n    }\n  );\n  if ([200, 201].includes(devs.status)) {\n    res.tv = devs.data.value.filter((d) => d.template === TV_MODEL);\n    res.thermostats = devs.data.value.filter(\n      (d: any) => d.template === THM_MODEL\n    );\n    res.tv = await Promise.all(\n      res.tv.map(async (tv) => {\n        delete tv.etag;\n        tv.properties = await getDeviceProperties(tv.id);\n        return tv;\n      })\n    );\n    res.thermostats = await Promise.all(\n      res.thermostats.map(async (thm) => {\n        delete thm.etag;\n        thm.properties = await getDeviceProperties(thm.id);\n        return thm;\n      })\n    );\n  }\n  return res;\n}\n\nexport async function getDeviceProperties(deviceId: string) {\n  const props = await axios.get<{ [propId: string]: any }>(\n    `https://${APP_URL}/api/devices/${deviceId}/properties?api-version=${API_VERSION}`,\n    {\n      headers: {\n        Authorization: API_KEY,\n      },\n    }\n  );\n  if ([200, 201].includes(props.status)) {\n    return props.data;\n  }\n  return {};\n}\n\nexport async function getTelemetryValue(\n  deviceId: string,\n  telemetryName: string\n) {\n  const res = await axios.get<{\n    value: any;\n  }>(\n    `https://${APP_URL}/api/devices/${deviceId}/telemetry/${telemetryName}?api-version=${API_VERSION}`,\n    {\n      headers: {\n        Authorization: API_KEY,\n      },\n    }\n  );\n  if ([200, 201].includes(res.status)) {\n    return res.data.value;\n  }\n  return null;\n}\n\nexport async function triggerCommand(\n  deviceId: string,\n  commandName: string,\n  commandPayload?: any\n) {\n  const res = await axios.post<{}>(\n    `https://${APP_URL}/api/devices/${deviceId}/commands/${commandName}?api-version=${API_VERSION}`,\n    commandPayload ?? {},\n    {\n      headers: {\n        Authorization: API_KEY,\n      },\n    }\n  );\n  if ([200, 201].includes(res.status)) {\n    return true;\n  }\n  return null;\n}\n\nexport async function setProperty(\n  deviceId: string,\n  propertyName: string,\n  propertyValue: any\n) {\n  const res = await axios.patch<{}>(\n    `https://${APP_URL}/api/devices/${deviceId}/properties?api-version=${API_VERSION}`,\n    { [propertyName]: propertyValue },\n    {\n      headers: {\n        Authorization: API_KEY,\n      },\n    }\n  );\n  if ([200, 201].includes(res.status)) {\n    return true;\n  }\n  return null;\n}\n","import {\n  List,\n  mergeStyleSets,\n  PrimaryButton,\n  Text,\n  TextField,\n} from \"@fluentui/react\";\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { getTelemetryValue, setProperty, triggerCommand } from \"./central\";\nimport { ThermostatProperties, TVProperties } from \"./types\";\n\ntype CardProps = {\n  data: any;\n};\ntype CardItem = { key: string; value: any; onEdit?: (val: any) => void };\n\nconst classNames = mergeStyleSets({\n  compactCard: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    height: \"100%\",\n  },\n  expandedCard: {\n    padding: \"16px 24px\",\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n  list: {\n    width: \"100%\",\n  },\n  item: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: 10,\n    selectors: {\n      \"&:hover\": {\n        textDecoration: \"underline\",\n        cursor: \"pointer\",\n      },\n    },\n  },\n});\n\nconst onRenderListItem = (item?: CardItem, index?: number) => (\n  <div className={classNames.item}>\n    <Text style={{ fontWeight: 600 }}>{item?.key}</Text>\n    {item?.onEdit ? (\n      <TextField\n        type=\"number\"\n        style={{ width: 60 }}\n        value={item.value}\n        onChange={(e, val) => {\n          item?.onEdit?.(val);\n        }}\n      />\n    ) : (\n      <Text>{item?.value}</Text>\n    )}\n  </div>\n);\n\nexport const TvCard = React.memo<CardProps>(({ data }) => {\n  const [currentPower, setCurrentPower] = useState(null);\n  const { properties }: { properties: TVProperties } = data;\n\n  const fetchTelemetry = useCallback(async () => {\n    setCurrentPower(await getTelemetryValue(data.properties.id, \"powerState\"));\n  }, [setCurrentPower, data.properties.id]);\n\n  useEffect(() => {\n    fetchTelemetry();\n  }, [fetchTelemetry]);\n\n  const items = useMemo<any[]>(\n    () => [\n      {\n        key: \"IPAddress\",\n        value: properties.ipaddress,\n      },\n      {\n        key: \"Power State\",\n        value: currentPower ? \"ON\" : \"OFF\",\n      },\n    ],\n    [currentPower, properties]\n  );\n\n  return (\n    <div className={classNames.expandedCard}>\n      <List\n        className={classNames.list}\n        items={items}\n        onRenderCell={onRenderListItem}\n      />\n      {currentPower ? (\n        <PrimaryButton\n          text=\"Power off\"\n          onClick={async () => {\n            await triggerCommand(properties.id, \"powerOff\");\n          }}\n        />\n      ) : (\n        <PrimaryButton\n          text=\"Power on\"\n          onClick={async () => {\n            await triggerCommand(properties.id, \"powerOn\");\n          }}\n        />\n      )}\n    </div>\n  );\n});\nexport const ThermostatCard = React.memo<CardProps>(({ data }) => {\n  const [currentTemperature, setCurrentTemperature] = useState(null);\n  const [targetTemperature, setTargetTemperature] = useState(0);\n  const { properties }: { properties: ThermostatProperties } = data;\n\n  const fetchTelemetry = useCallback(async () => {\n    setCurrentTemperature(\n      await getTelemetryValue(data.properties.id, \"temperature\")\n    );\n  }, [setCurrentTemperature, data.properties.id]);\n\n  useEffect(() => {\n    fetchTelemetry();\n  }, [fetchTelemetry]);\n\n  const items = useMemo<CardItem[]>(\n    () => [\n      {\n        key: \"Temperature\",\n        value: currentTemperature ? `${currentTemperature} Â°C` : \"-\",\n      },\n      {\n        key: \"Target Temperature\",\n        value: targetTemperature,\n        onEdit: (val) => {\n          setTargetTemperature(parseInt(val));\n        },\n      },\n    ],\n    [currentTemperature, targetTemperature]\n  );\n\n  return (\n    <div className={classNames.expandedCard}>\n      <List\n        className={classNames.list}\n        items={items}\n        onRenderCell={onRenderListItem}\n      />\n      <PrimaryButton\n        text=\"Set Temperature\"\n        onClick={async () => {\n          await setProperty(\n            properties.id,\n            \"targetTemperature\",\n            targetTemperature\n          );\n        }}\n      />\n    </div>\n  );\n});\n","import axios from \"axios\";\nimport { MAP_STATESET_ID, MAP_SUBSCRIPTION_KEY } from \"./common\";\nconst GEOGRAPHY = \"us\";\nconst API_VERSION = \"2.0\";\n// const COLLECTION_ID = \"unit\";\n\n// export async function getFeatures(\n//   url: string | null,\n//   features?: any[]\n// ): Promise<any[]> {\n//   if (!features) {\n//     features = [];\n//   }\n//   if (!url) {\n//     url = `https://${GEOGRAPHY}.atlas.microsoft.com/wfs/datasets/${MAP_DATASET_ID}/collections/${COLLECTION_ID}/items?subscription-key=${MAP_SUBSCRIPTION_KEY}&api-version=${API_VERSION}`;\n//   } else {\n//     url += `&subscription-key=${MAP_SUBSCRIPTION_KEY}`;\n//   }\n//   const res = await axios.get<any>(url);\n//   if (res.status === 200) {\n//     features = features.concat(res.data.features);\n//     const nextLink = res.data.links.find((l: any) => l.rel === \"next\");\n//     if (nextLink) {\n//       features = await getFeatures(nextLink.href, features);\n//     }\n//   }\n//   return features;\n// }\n\n// export async function reserveRoom(roomId: string, free: boolean = false) {\n//   const res = await fetch(\n//     `https://${GEOGRAPHY}.atlas.microsoft.com/featurestatesets/${MAP_DATASET_ID}/featureStates/${roomId}?subscription-key=${MAP_SUBSCRIPTION_KEY}&api-version=${API_VERSION}`,\n//     {\n//       method: \"PUT\",\n//       headers: {\n//         \"Content-Type\": \"application/json\",\n//         \"Content-Encoding\": \"utf-8\",\n//       },\n//       body: JSON.stringify({\n//         states: [\n//           {\n//             keyName: \"reserved\",\n//             value: !free,\n//             eventTimestamp: new Date().toISOString(),\n//           },\n//         ],\n//       }),\n//     }\n//   );\n//   if (res.status > 400) {\n//     throw new Error(`State can't be set`);\n//   }\n// }\n\n// export async function occupyRoom(roomId: string, free: boolean = false) {\n//   const res = await fetch(\n//     `https://${GEOGRAPHY}.atlas.microsoft.com/featurestatesets/${MAP_DATASET_ID}/featureStates/${roomId}?subscription-key=${MAP_SUBSCRIPTION_KEY}&api-version=${API_VERSION}`,\n//     {\n//       method: \"PUT\",\n//       headers: {\n//         \"Content-Type\": \"application/json\",\n//         \"Content-Encoding\": \"utf-8\",\n//       },\n//       body: JSON.stringify({\n//         states: [\n//           {\n//             keyName: \"occupied\",\n//             value: !free,\n//             eventTimestamp: new Date().toISOString(),\n//           },\n//         ],\n//       }),\n//     }\n//   );\n//   if (res.status > 400) {\n//     throw new Error(`State can't be set`);\n//   }\n// }\n\nexport async function setFeatureState(\n  roomId: string,\n  keyName: string,\n  value: string\n) {\n  const data = {\n    states: [\n      {\n        keyName,\n        value,\n        eventTimestamp: new Date().toISOString(),\n      },\n    ],\n  };\n\n  try {\n    const res = await axios.put<any>(\n      `https://${GEOGRAPHY}.atlas.microsoft.com/featureStateSets/${MAP_STATESET_ID}/featureStates/${roomId}?subscription-key=${MAP_SUBSCRIPTION_KEY}&api-version=${API_VERSION}`,\n      data\n    );\n    if ([200, 201].includes(res.status)) {\n      return res.data;\n    }\n    return res.statusText;\n  } catch (ex: any) {\n    if (ex.response.status === 400) {\n      return null;\n    }\n  }\n}","import React, { useCallback, useMemo, useRef, useState } from \"react\";\nimport \"./App.css\";\nimport { indoor, control } from \"azure-maps-indoor\";\nimport * as atlas from \"azure-maps-control\";\nimport { isEqual } from \"lodash\";\nimport { useEffect } from \"react\";\nimport {\n  FontWeights,\n  mergeStyleSets,\n  Text,\n  HoverCard,\n  IExpandingCardProps,\n  DirectionalHint,\n} from \"@fluentui/react\";\nimport { useId } from \"@fluentui/react-hooks\";\nimport {\n  getRandomPosition,\n  useCard,\n  MAP_SUBSCRIPTION_KEY,\n  MAP_STATESET_ID,\n  MAP_TILESET_ID,\n  MAP_LON,\n  MAP_LAT,\n  FEATURE_MAP,\n} from \"./common\";\nimport TvIcon from \"./icons/tv.png\";\nimport ThermostatIcon from \"./icons/thermostat.png\";\nimport { ThermostatProperties, TVProperties } from \"./types\";\nimport { getDevices, getTelemetryValue } from \"./central\";\nimport { ThermostatCard, TvCard } from \"./Cards\";\nimport { setFeatureState } from \"./map\";\n\nconst mapId = \"map-id\";\n\nconst App = React.memo(() => {\n  const { state: cardState, open: openCard } = useCard();\n  const [devices, setDevices] = useState({});\n  const { current: tvDataSource } = useRef<atlas.source.DataSource>(\n    new atlas.source.DataSource()\n  );\n  const { current: thermostatDataSource } = useRef<atlas.source.DataSource>(\n    new atlas.source.DataSource()\n  );\n  const [features, setFeatures] = useState<any[]>([]);\n  const labelId = useId(\"card-label\");\n  const descriptionId = useId(\"card-description\");\n  const popupRef = useRef<HTMLDivElement>(null);\n\n  const classNames = mergeStyleSets({\n    compactCard: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      height: \"100%\",\n    },\n    expandedCard: {\n      padding: \"16px 24px\",\n      display: \"flex\",\n    },\n    item: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      selectors: {\n        \"&:hover\": {\n          textDecoration: \"underline\",\n          cursor: \"pointer\",\n        },\n      },\n    },\n    cardIcon: {\n      width: 40,\n    },\n  });\n\n  const onMouseOver = useCallback(\n    (map, event, layer) => {\n      const features = map.layers.getRenderedShapes(event.position, layer);\n      features.forEach((feature: any) => {\n        const template =\n          feature.dataSource.id === tvDataSource.getId() ? \"tv\" : \"thermostat\";\n        openCard(\n          feature.data.properties.featureId,\n          { ...feature.data, template },\n          [\n            atlas.Pixel.getX(event.pixel!) - 10,\n            atlas.Pixel.getY(event.pixel!) - 10,\n          ]\n        );\n        popupRef.current?.focus();\n      });\n    },\n    [openCard, tvDataSource]\n  );\n\n  const refresh = useCallback(async () => {\n    if (features.length === 0) {\n      return;\n    }\n    const devs = await getDevices();\n    await Promise.all(devs.thermostats.map(async (thm) => {\n      const newState = await getTelemetryValue(thm.id, 'temperature');\n      if (newState) {\n        await setFeatureState(`UNIT${FEATURE_MAP[thm.properties?.room as keyof typeof FEATURE_MAP]}`, 'temperature', newState);\n      }\n    }));\n    await Promise.all(devs.tv.map(async (tv) => {\n      const newState = await getTelemetryValue(tv.id, 'powerState');\n      if (newState) {\n        await setFeatureState(`UNIT${FEATURE_MAP[tv.properties?.room as keyof typeof FEATURE_MAP]}`, 'powerState', newState);\n      }\n    }));\n    if (isEqual(devs, devices)) {\n      return;\n    }\n    tvDataSource.clear();\n    thermostatDataSource.clear();\n    await Promise.all(\n      devs.tv.map(async (tv) => {\n        if (tv.properties?.room) {\n          const feature = features.find(\n            (feature) =>\n              parseInt(feature.properties.name) === tv.properties?.room\n          );\n          if (feature) {\n            tvDataSource.add(\n              new atlas.data.Feature<atlas.data.Geometry, TVProperties>(\n                new atlas.data.Point(getRandomPosition(feature)),\n                {\n                  id: tv.id,\n                  name: tv.displayName,\n                  ipaddress: tv.properties?.ipAddress ?? null,\n                }\n              )\n            );\n          }\n        }\n      })\n    );\n\n    await Promise.all(\n      devs.thermostats.map(async (thm) => {\n        if (thm.properties?.room) {\n          const feature = features.find(\n            (feature) =>\n              parseInt(feature.properties.name) === thm.properties?.room\n          );\n          if (feature) {\n            thermostatDataSource.add(\n              new atlas.data.Feature<atlas.data.Geometry, ThermostatProperties>(\n                new atlas.data.Point(getRandomPosition(feature)),\n                {\n                  id: thm.id,\n                  name: thm.displayName,\n                  targetTemperature: thm.properties?.targetTemperature ?? null,\n                  maxTempSinceLastReboot:\n                    thm.properties?.maxTempSinceLastReboot ?? null,\n                }\n              )\n            );\n          }\n        }\n      })\n    );\n    setDevices(devs);\n  }, [thermostatDataSource, tvDataSource, features, devices]);\n\n  useEffect(() => {\n    refresh();\n    const inId = setInterval(refresh, 10000);\n    return () => clearInterval(inId);\n  }, [refresh]);\n\n  useEffect(() => {\n    const indoorMap = new atlas.Map(mapId, {\n      //use your facility's location\n      center: [MAP_LON, MAP_LAT],\n      //or, you can use bounds: [# west, # south, # east, # north] and replace # with your Map bounds\n      view: \"Auto\",\n      authOptions: {\n        authType: atlas.AuthenticationType.subscriptionKey,\n        subscriptionKey: MAP_SUBSCRIPTION_KEY,\n      },\n      zoom: 18.5,\n    });\n    indoorMap.events.add(\"ready\", async () => {\n      const levelControl = new control.LevelControl({\n        position: atlas.ControlPosition.TopRight,\n      });\n\n      const indoorManager = new indoor.IndoorManager(indoorMap, {\n        levelControl: levelControl, //level picker\n        tilesetId: MAP_TILESET_ID,\n        statesetId: MAP_STATESET_ID,\n      });\n\n      if (MAP_STATESET_ID.length > 0) {\n        indoorManager.setDynamicStyling(true);\n      }\n\n      indoorMap.events.add(\"levelchanged\", indoorManager, (eventData) => {\n        //put code that runs after a level has been changed\n        console.log(\"The level has changed:\", eventData);\n      });\n\n      indoorMap.events.add(\"facilitychanged\", indoorManager, (eventData) => {\n        //put code that runs after a facility has been changed\n        console.log(\"The facility has changed:\", eventData);\n      });\n\n      indoorMap.events.add(\"click\", function (e) {\n        const features = indoorMap.layers.getRenderedShapes(e.position, \"unit\");\n        features.forEach((feature: any) => {\n          if (feature.layer.id.endsWith(\"indoor_unit_office\")) {\n            console.log(feature);\n          }\n        });\n      });\n\n      await indoorMap.imageSprite.add(\"tv-icon\", TvIcon);\n      await indoorMap.imageSprite.add(\"thermostat-icon\", ThermostatIcon);\n      indoorMap.sources.add(tvDataSource);\n      indoorMap.sources.add(thermostatDataSource);\n\n      const tvsLayer = new atlas.layer.SymbolLayer(tvDataSource, undefined, {\n        minZoom: 19,\n        iconOptions: {\n          //Pass in the id of the custom icon that was loaded into the map resources.\n          image: \"tv-icon\",\n\n          //Optionally scale the size of the icon.\n          size: 0.2,\n        },\n      });\n\n      const thmsLayer = new atlas.layer.SymbolLayer(\n        thermostatDataSource,\n        undefined,\n        {\n          minZoom: 19,\n          iconOptions: {\n            //Pass in the id of the custom icon that was loaded into the map resources.\n            image: \"thermostat-icon\",\n\n            //Optionally scale the size of the icon.\n            size: 0.2,\n          },\n        }\n      );\n\n      indoorMap.layers.add(tvsLayer);\n      indoorMap.layers.add(thmsLayer);\n      indoorMap.events.add(\"mouseover\", tvsLayer, (e) =>\n        onMouseOver(indoorMap, e, tvsLayer)\n      );\n      indoorMap.events.add(\"mouseover\", thmsLayer, (e) =>\n        onMouseOver(indoorMap, e, thmsLayer)\n      );\n\n      /** Initialize features */\n      indoorMap.events.add(\"load\", (e) => {\n        try {\n          setFeatures(indoorMap.layers.getRenderedShapes(undefined, \"unit\"));\n        } catch (ex) {\n          console.log(ex);\n        }\n      });\n    });\n\n  }, [setFeatures, onMouseOver, tvDataSource, thermostatDataSource]);\n\n  const onRenderExpandedCard = useCallback(\n    (): JSX.Element => (\n      <>\n        {cardState.data.template === \"tv\" && <TvCard data={cardState.data} />}\n        {cardState.data.template === \"thermostat\" && (\n          <ThermostatCard data={cardState.data} />\n        )}\n      </>\n    ),\n    [cardState]\n  );\n\n  const onRenderCompactCard = useCallback((): JSX.Element => {\n    return (\n      <div className={classNames.compactCard}>\n        <img\n          src={cardState.data.template === \"tv\" ? TvIcon : ThermostatIcon}\n          alt='device-icon'\n          className={classNames.cardIcon}\n        />\n        <Text block variant=\"xLarge\" className={styles.title} id={labelId}>\n          {cardState.data.properties.name}\n        </Text>\n        <Text block variant=\"small\" id={descriptionId}>\n          {cardState.data.properties.ipaddress}\n        </Text>\n      </div>\n    );\n  }, [cardState, classNames, descriptionId, labelId]);\n\n  const expandingCardProps: IExpandingCardProps = useMemo(\n    () => ({\n      onRenderCompactCard,\n      onRenderExpandedCard,\n      renderData: {},\n      directionalHint: DirectionalHint.rightTopEdge,\n      gapSpace: 16,\n      calloutProps: {\n        isBeakVisible: true,\n      },\n    }),\n    [onRenderCompactCard, onRenderExpandedCard]\n  );\n\n  return (\n    <div className=\"App\">\n      <div id={mapId}></div>\n      {cardState.show && (\n        <div\n          style={{\n            position: \"absolute\",\n            left: cardState.pagePosition?.[0],\n            top: cardState.pagePosition?.[1],\n            height: \"100%\",\n          }}\n        >\n          <HoverCard\n            expandingCardProps={expandingCardProps}\n            cardDismissDelay={300}\n            trapFocus\n            sticky\n            instantOpenOnClick\n          >\n            <div style={{ height: 20, width: 20 }}></div>\n          </HoverCard>\n        </div>\n        //   <Text block variant=\"xLarge\" className={styles.title} id={labelId}>\n        //     {cardState.data.properties.name}\n        //   </Text>\n        //   <Text block variant=\"small\" id={descriptionId}>\n        //     Message body is optional. If help documentation is available, consider adding a link to learn more at the\n        //     bottom.\n        //   </Text>\n        //   <Stack horizontal tokens={{ childrenGap: 40 }}>\n        //     {!cardState.data.state['stateValue:occupied'] &&\n        //       <Link onClick={() => {\n        //         reserveRoom(cardState.id as string, cardState.data.state['stateValue:reserved']);\n        //         dismissCard()\n        //       }} className={styles.link}>\n        //         {!cardState.data.state['stateValue:reserved'] ? 'Reserve Room' : 'Free Room'}\n        //       </Link>}\n        //     <Link onClick={() => {\n        //       occupyRoom(cardState.id as string, cardState.data.state['stateValue:occupied']);\n        //       dismissCard()\n        //     }} className={styles.link}>\n        //       {!cardState.data.state['stateValue:occupied'] ? 'Occupy room' : 'Free Room'}\n        //     </Link>\n        //   </Stack>\n        // </Card>\n      )}\n    </div>\n  );\n});\n\nconst styles = mergeStyleSets({\n  button: {\n    width: 130,\n  },\n  card: {\n    width: 320,\n    padding: \"20px 24px\",\n  },\n  title: {\n    marginBottom: 12,\n    fontWeight: FontWeights.bold,\n  },\n  link: {\n    display: \"block\",\n    marginTop: 20,\n  },\n});\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n// import { HoverCardBasicExample } from \"./Card\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nconsole.log(process.env);\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}